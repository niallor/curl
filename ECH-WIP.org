* ECH-WIP.org -- tracking work to demonstrate ECH in curl

** Refactor changes made for ESNI-demo

   See [[file:ESNI-demo.changed-files][list of files changed for ESNI-demo]]

*** DONE Refactor upstream docs/ECH.md
    CLOSED: [2021-02-24 Wed 10:36]
    :PROPERTIES:
    :reference: docs/ESNI.md
    :target:   docs/ECH.md
    :END:

    - CLOSING NOTE [2021-02-24 Wed 10:32]

*** DONE Add configuration option *--enable-ech* and checking to **autoconf**
    CLOSED: [2021-02-24 Wed 12:51]
    :PROPERTIES:
    :target:   configure.ac
    :END:

    - CLOSING NOTE [2021-02-24 Wed 12:51]
*** DONE Expose _ECH_ in curl tool 'Features' list
    CLOSED: [2021-02-24 Wed 11:52]
    :PROPERTIES:
    :target:  include/curl/curl.h
    :target+: lib/version.c
    :target+: src/tool_help.c
    :END:

    - CLOSING NOTE [2021-02-24 Wed 11:52]
*** DONE Expose *--ech* and *--echconfig* in curl tool *--help* display
    CLOSED: [2021-02-24 Wed 11:52]
    :PROPERTIES:
    :target:   src/tool_help.c
    :END:

    - CLOSING NOTE [2021-02-24 Wed 11:52]
*** DONE Document CLI option *--[no-]esni* (boolean)
    CLOSED: [2021-02-24 Wed 12:51]
    :PROPERTIES:
    :reference: docs/cmdline-opts/esni.d
    :target: docs/cmdline-opts/ech.d
    :END:

    - CLOSING NOTE [2021-02-24 Wed 12:51]
*** DONE Document CLI option *--echconfig* (base64/@filename)
    CLOSED: [2021-02-24 Wed 12:51]
    :PROPERTIES:
    :reference: docs/cmdline-opts/esni-load.d
    :target: docs/cmdline-opts/echconfig.d
    :END:

    - CLOSING NOTE [2021-02-24 Wed 12:51]
*** DONE Include description of new CLI options in *man* file *curl.1*
    CLOSED: [2021-02-24 Wed 14:03]
    :PROPERTIES:
    :target:   docs/cmdline-opts/Makefile.inc
    :target+:   docs/cmdline-opts/ech.d
    :target+:   docs/cmdline-opts/echconfig.d
    :END:
    - CLOSING NOTE [2021-02-24 Wed 14:03]
*** DONE Implement parsing of CLI options
    CLOSED: [2021-02-25 Thu 19:01]
    :PROPERTIES:
    :target:  src/tool_cfgable.c
    :target+: src/tool_cfgable.h
    :target+: src/tool_getparam.c
    :END:

    - CLOSING NOTE [2021-02-25 Thu 19:01]
*** DONE Declare and document libcurl options to support ECH
    CLOSED: [2021-02-26 Fri 16:44]
    :Properties:
    :target:   include/curl/curl.h
    :target+:  docs/libcurl/curl_easy_setopt.3
    :target+:  docs/libcurl/opts/CURLOPT_ECH_CONFIG.3
    :target+:  docs/libcurl/opts/CURLOPT_ECH_STATUS.3
    :target+:  docs/libcurl/opts/Makefile.inc
    :target+:  docs/libcurl/symbols-in-versions
    :reference:  docs/libcurl/opts/CURLOPT_ESNI_ASCIIRR.3
    :reference+:  docs/libcurl/opts/CURLOPT_ESNI_COVER.3
    :reference+:  docs/libcurl/opts/CURLOPT_ESNI_STATUS.3
    :END:
    - CLOSING NOTE [2021-02-26 Fri 16:44]
*** DONE Propagate CLI options for ECH to corresponding libcurl options
    CLOSED: [2021-02-27 Sat 17:21]
    :PROPERTIES:
    :target:  src/tool_operate.c
    :target+: lib/urldata.h
    :target+: lib/setopt.c
    :END:
    - CLOSING NOTE [2021-02-27 Sat 17:21]
*** NEXT Propagate libcurl options for ECH to OpenSSL backend
    :PROPERTIES:
    :target:  lib/Makefile.inc
    :target+: lib/ech.c
    :target+: lib/ech.h
    :target+: lib/setopt.c ?
    :target+: lib/urldata.h ?
    :target+: lib/vtls/openssl.c (calls from libcurl code)
    :reference:  lib/esni.c (rename to ech.c)
    :reference+: lib/esni.h (rename to ech.h)
    :END:
*** TODO Propagate ECH signals from OpenSSL backend interface to OpenSSL
    :PROPERTIES:
    :target:  lib/vtls/openssl.c
    :END:
*** TODO Review other changes made for ESNI-demo

- lib/doh.c
- lib/doh.h
- tests/unit/unit1650.c
- tests/unit/unit1655.c

# Local Variables:
# mode: org
# End:
*** TODO Add validation tests along propagation path
*** TODO Add unit tests
